---
title: Go的基本数据类型之整数(Integer)
date: 2021-02-26T13:26:16+08:00
categories:
- Go程序设计
draft: true
---

**整数区分有符号和无符号**，且有四种大小：8位、16位、32位、64位。

```go
int8, 	int16, 	int32,	int64		// 有符号
uint8, 	uint16,	uint32,	uint64	// 无符号
```

还有两种类型：`int`和`uint`，它们的大小相同，32位或64位，与平台有关，不同的编译器即使在相同的硬件上得到的结果可能也不相同。

`rune`类型是`int32`的同义词，表示该值是一个Unicode码点(*code point*)，`byte`是`uint8`的同义词，表示该值是原始数据(*raw data*)。

`uintptr`也是一个整型类型，但大小不确定，主要用于低级编程（如调用`C`语言库）。

`int`, `uint`, `uintptr`与带大小的类型如`int32`, `uint64`等都是不同的类型，即使底层的类型相同，一起使用时需要做类型转换。

有符号整数以2的补码表示，最高位是符号位。n位有符号整数的范围是：`-2^(n-1) ~ 2^(n-1)-1`，n位无符号整数的范围是`0 ~ 2^n-1`。

```go
r1, _ := utf8.DecodeRuneInString("世")
fmt.Printf("r1 = %c\n", r1)				// 世
```

---

**二元操作符**按优先级分为5个级别，从上到下，优先级降低，同一优先级的操作符按照从左到右的顺序执行：

```go
* 	/ 	% 	<< 	>> 	& 	&^
+ 	-		|		^
== 	!=	<		<=	>		>=
&&
||
```

> - 为了表意，尽量使用小括号*()*凸显或保证运算顺序。
> - 前两行的操作符都有对应的赋值操作符，如`+=`, `%=`。
> - `+`, `-`, `*`, `/`四个操作法可以用于整数、浮点数和复数；`%`只能用于整数，其结果的符号与被除数相同；对于`/`，如果两个操作数都是整数，则结果为整数，如果有一个操作数是浮点数，则结果为浮点数。

```go
r1 := -5 % -3
r2 := 5 % -3
fmt.Printf("%d, %d\n", r1, r2) // -2, 2

div1 := 5 / 4
div2 := 5.0 / 4
fmt.Printf("%v, %v\n", div1, div2) // 1, 1.25
```

---

**比较运算符**：

```go
== 	!=	<		<= 	>		>=
```

所有的基本类型，如布尔、数值、字符串都是可比较的，即同一类型的两个值，可以使用上述比较运算符直接比较。

```go
fmt.Printf("%t\n", 10 < 5)					// false
fmt.Printf("%t\n", 10 < 20.1)				// true
fmt.Printf("%t\n", "abc" >= "ab")		// true
```

---

**位运算符：**

```go
&		位AND，位的交集
|		位OR，位的并集
^		位XOR，用作二元运算符时表示异或，用作单目运算符时表示按位取反
&^	位清空(AND NOT), z=x &^ y, 如果y的位为1，则z对应的位为0，否则与x对应的位相同
<<	位左移
>>	位右移
```

```go
// bit operation
const b1 uint8 = 1 << 1 | 1 << 5	// set 1 and 5 bit
const b2 uint8 = 1 << 1 | 1 << 2	// set 1 and 2 bit

fmt.Printf("%08b\n", b1)		// 00100010
fmt.Printf("%08b\n", b2)		// 00000110

fmt.Printf("%08b\n", b1 & b2)		// 00000010
fmt.Printf("%08b\n", b1 | b2)		// 00100110
fmt.Printf("%08b\n", b1 ^ b2)		// 00100100
fmt.Printf("%08b\n", b1 &^ b2)	// 00100100
```

> - %08b：将结果以8位展示，不足8位的用0补齐。
> - 对于无符号数，左移右移都是补0，对于有符号数，左移补0，右移补符号位。所以整数在做位运算时，要注意使用无符号。

在Go语言中，对于不能为负值的整数，一般使用有符号数来表示，比如数组的长度，`len`函数返回的是`int`，如果返回的是`uint`，在与0比较时永远为true：

```go
data := []string{"hello", "world"}
for i := len(data) - 1; i >= 0; i-- {
  println(data[i])
}
```

---

**类型转换**

将一个值从一个类型转换成另一个类型，需要进行显示的类型转换。二元操作符的算术和逻辑运算（移位操作除外），要求两个操作数的类型完全一样。

`T(x)`表示将x转换成类型T。不同宽度类型的整数之间转换，或者整数与浮点数之间转换，可能会修改变量的值或丢失精度，比如浮点数转换成整数，小数部分会被丢弃。

```go
// type conversion
var n1 int16 = 10
var n2 int32 = 20
var sum int = int(n1) + int(n2)
fmt.Println(sum)		// 30

f1 := 3.1415
i1 := int(f1)
fmt.Println(i1)		// 3
```

---

---







> 参考：《The Go Programming Language》(Alan Donovan, Brian Kernighan) (英文版)